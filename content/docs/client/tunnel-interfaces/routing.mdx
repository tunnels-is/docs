---
title: Routing
description: Configure routing for tunnel interfaces
---

Configure how network traffic is routed through your tunnel interfaces using the route configuration options.

---

# Route Configuration Structure

Routes are configured in your tunnel's `.conf` file using two main fields:

```md
- `EnableDefaultRoute` - Boolean flag to route all traffic through the tunnel
- `Routes` - Array of custom route objects for specific networks
```

---

# EnableDefaultRoute

Controls whether all internet traffic routes through the VPN tunnel.

### Configuration

```json
{
  "EnableDefaultRoute": true
}
```

**Values**:

```md
- `true` - Routes all traffic (`0.0.0.0/0`) through the tunnel
- `false` - Only routes traffic for networks specified in the `Routes` array
```

**Default**: `false`

### Example: Full Tunnel

Route all traffic through the VPN:

```json
{
  "ServerID": "your-server-id",
  "Tag": "tunnels",
  "EnableDefaultRoute": true,
  "Routes": []
}
```

---

# Routes Array

Define specific networks to route through the tunnel (split tunneling).

### Route Object Structure

```json
{
  "Address": "10.0.0.0/8",
  "Metric": "0",
  "Gateway": ""
}
```

**Fields**:

| Field | Type | Description |
|-------|------|-------------|
| `Address` | string | Network in CIDR notation (e.g., `10.0.0.0/8`, `192.168.1.0/24`) |
| `Metric` | string | Route priority (lower = higher priority). Common values: `"0"`, `"1"`, `"100"` |
| `Gateway` | string | Leave empty (`""`) for client configurations |

### Example: Split Tunnel

Route only private networks through the tunnel:

```json
{
  "ServerID": "your-server-id",
  "Tag": "office",
  "EnableDefaultRoute": false,
  "Routes": [
    {
      "Address": "10.0.0.0/8",
      "Metric": "0",
      "Gateway": ""
    },
    {
      "Address": "192.168.0.0/16",
      "Metric": "10",
      "Gateway": ""
    }
  ]
}
```

### Example: Single Host Route

Route traffic for a specific server:

```json
{
  "Routes": [
    {
      "Address": "8.8.8.8/32",
      "Metric": "0",
      "Gateway": ""
    }
  ]
}
```

---

# Common CIDR Networks

| Network | CIDR | Description |
|---------|------|-------------|
| All traffic | `0.0.0.0/0` | Default route (use `EnableDefaultRoute: true`) |
| Class A Private | `10.0.0.0/8` | Private network range |
| Class B Private | `172.16.0.0/12` | Private network range |
| Class C Private | `192.168.0.0/16` | Private network range |
| Subnet | `192.168.1.0/24` | Specific subnet (256 addresses) |
| Single Host | `8.8.8.8/32` | Single IP address |

---

# Route Priority (Metric)

The `Metric` field determines route priority when multiple routes exist for the same destination.

**Priority Rules**:

```md
- Lower metric = Higher priority
- `"0"` = Highest priority
- `"100"` = Lower priority
- Default system routes typically use metric `100` or higher
```

### Example: Priority Configuration

```json
{
  "Routes": [
    {
      "Address": "10.0.0.0/16",
      "Metric": "0",
      "Gateway": ""
    },
    {
      "Address": "10.0.0.0/8",
      "Metric": "10",
      "Gateway": ""
    }
  ]
}
```

In this example, `10.0.0.0/16` has higher priority (metric `0`) than the broader `10.0.0.0/8` (metric `10`).

---

# Complete Configuration Example

Full tunnel configuration with routing:

```json
{
  "ServerID": "abc123def456",
  "Tag": "office",
  "IFName": "office",
  "IPv4Address": "172.22.22.1",
  "NetMask": "255.255.255.255",
  "EnableDefaultRoute": false,
  "Routes": [
    {
      "Address": "10.0.0.0/8",
      "Metric": "0",
      "Gateway": ""
    },
    {
      "Address": "192.168.0.0/16",
      "Metric": "10",
      "Gateway": ""
    }
  ],
  "DNSServers": ["8.8.8.8", "1.1.1.1"],
  "AutoReconnect": true,
  "KillSwitch": true,
  "MTU": 1420
}
```

---

# Configuration Location

Tunnel configurations are stored in JSON format:

```md
- Default location: `<basePath>/tunnel/`
- Filename pattern: `<Tag>.conf`
- Example: `<basePath>/tunnel/office.conf`
```

To edit routing configuration:

```bash
# Edit tunnel configuration
nano /opt/tunnels/tunnel/tunnels.conf

# Restart the tunnel to apply changes
systemctl restart tunnels
```