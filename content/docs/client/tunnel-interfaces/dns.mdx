---
title: DNS
description: DNS configuration for tunnel interfaces
---

Configure DNS servers and custom DNS records for your tunnel interfaces.

---

# DNS Configuration Fields

DNS is configured in your tunnel's `.conf` file using three main fields:

```md
- `DNSBlocking` - Boolean flag to enable DNS-based domain blocking
- `DNSServers` - Array of custom DNS server IP addresses
- `DNSRecords` - Array of custom DNS record objects for local resolution
```

---

# DNSBlocking

Enables or disables DNS-based domain blocking for the tunnel.

### Configuration

```json
{
  "DNSBlocking": true
}
```

**Values**:

```md
- `true` - Enable DNS blocking (uses configured blocklists)
- `false` - Disable DNS blocking (all domains allowed)
```

**Default**: `true`

### Example

```json
{
  "ServerID": "your-server-id",
  "Tag": "tunnels",
  "DNSBlocking": true
}
```

---

# DNSServers

Array of custom DNS server IP addresses to use for this tunnel.

### Configuration

```json
{
  "DNSServers": ["8.8.8.8", "1.1.1.1"]
}
```

**Format**:

```md
- Array of IPv4 addresses as strings
- Empty array `[]` uses global default DNS servers
- Servers are queried in order
```

**Default**: `[]` (uses global DNS: `1.1.1.1` and `8.8.8.8`)

### Example: Custom DNS Servers

```json
{
  "ServerID": "your-server-id",
  "Tag": "office",
  "DNSServers": [
    "8.8.8.8",
    "1.1.1.1",
    "9.9.9.9"
  ]
}
```

### Example: Internal DNS

```json
{
  "DNSServers": [
    "10.0.0.1",
    "192.168.1.1"
  ]
}
```

---

# DNSRecords

Array of custom DNS records for local domain resolution.

### DNSRecord Object Structure

```json
{
  "Domain": "api.local",
  "Wildcard": false,
  "IP": ["192.168.1.100"],
  "TXT": []
}
```

**Fields**:

| Field | Type | Description |
|-------|------|-------------|
| `Domain` | string | Domain name to resolve (e.g., `api.local`, `*.example.com`) |
| `Wildcard` | bool | Enable wildcard subdomain matching |
| `IP` | []string | Array of IPv4 addresses to return for A records |
| `TXT` | []string | Array of TXT record values (optional) |

### Example: Single Domain

```json
{
  "DNSRecords": [
    {
      "Domain": "api.local",
      "Wildcard": false,
      "IP": ["192.168.1.100"],
      "TXT": []
    }
  ]
}
```

### Example: Wildcard Domain

```json
{
  "DNSRecords": [
    {
      "Domain": "example.com",
      "Wildcard": true,
      "IP": ["10.0.0.50"],
      "TXT": []
    }
  ]
}
```

**Wildcard Behavior**:

```md
- `Wildcard: false` - Only matches exact domain (`example.com`)
- `Wildcard: true` - Matches exact domain AND all subdomains (`*.example.com`, `api.example.com`)
```

### Example: Multiple IPs

```json
{
  "DNSRecords": [
    {
      "Domain": "loadbalancer.local",
      "Wildcard": false,
      "IP": [
        "192.168.1.100",
        "192.168.1.101",
        "192.168.1.102"
      ],
      "TXT": []
    }
  ]
}
```

### Example: TXT Records

```json
{
  "DNSRecords": [
    {
      "Domain": "verify.example.com",
      "Wildcard": false,
      "IP": [],
      "TXT": [
        "v=spf1 include:_spf.google.com ~all",
        "verification=abc123"
      ]
    }
  ]
}
```

---

# DNS Resolution Order

When a DNS query is received, the tunnel resolves it in this order:

```md
1. DNS cache check
2. Tunnel-specific `DNSRecords` (custom local records)
3. Global `DNSRecords` (if no tunnel match)
4. Upstream DNS query (using `DNSServers` or global defaults)
5. Apply `DNSBlocking` rules (if enabled)
```

---

# Complete Configuration Example

Full tunnel configuration with DNS settings:

```json
{
  "ServerID": "abc123def456",
  "Tag": "office",
  "IFName": "office",
  "IPv4Address": "172.22.22.1",
  "NetMask": "255.255.255.255",
  "DNSBlocking": true,
  "DNSServers": [
    "8.8.8.8",
    "1.1.1.1"
  ],
  "DNSRecords": [
    {
      "Domain": "api.internal",
      "Wildcard": false,
      "IP": ["10.0.0.100"],
      "TXT": []
    },
    {
      "Domain": "services.internal",
      "Wildcard": true,
      "IP": ["10.0.0.200"],
      "TXT": []
    }
  ],
  "EnableDefaultRoute": true,
  "AutoReconnect": true,
  "MTU": 1420
}
```

---

# Common Use Cases

### Local Development

Route local domains to development servers:

```json
{
  "DNSRecords": [
    {
      "Domain": "dev.local",
      "Wildcard": true,
      "IP": ["127.0.0.1"],
      "TXT": []
    }
  ]
}
```

Resolves:

```md
- `dev.local` → `127.0.0.1`
- `api.dev.local` → `127.0.0.1`
- `app.dev.local` → `127.0.0.1`
```

### Internal Services

Map internal service names to private IPs:

```json
{
  "DNSRecords": [
    {
      "Domain": "database.internal",
      "Wildcard": false,
      "IP": ["10.0.1.50"],
      "TXT": []
    },
    {
      "Domain": "cache.internal",
      "Wildcard": false,
      "IP": ["10.0.1.51"],
      "TXT": []
    }
  ]
}
```

### Split Horizon DNS

Use different DNS servers for internal vs external queries:

```json
{
  "DNSServers": ["10.0.0.1"],
  "DNSRecords": [
    {
      "Domain": "internal.company.com",
      "Wildcard": true,
      "IP": ["10.0.2.100"],
      "TXT": []
    }
  ]
}
```

---

# Configuration Location

Tunnel configurations are stored in JSON format:

```md
- Linux/macOS: `~/.tunnels/tunnels/<Tag>.conf`
- Windows: `%APPDATA%\tunnels\tunnels\<Tag>.conf`
- Default filename: `tunnels.conf`
```

To edit DNS configuration:

```bash
# Edit tunnel configuration
nano ~/.tunnels/tunnels/tunnels.conf

# Or custom tunnel
nano ~/.tunnels/tunnels/office.conf

# Restart the tunnel to apply changes
systemctl restart tunnels
```